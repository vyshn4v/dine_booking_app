<section class="admin_product_table w-100 container-fluid" style="min-height: 85vh;">
    <div>
        <div class="thead-dark">
            <h4 class="p-5">Restaurants</h4>
        </div>
        <div class="">
            {{#checklength restaurants 0}}
            <table class="table-responsive-md mt-5" id="myTable">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col">No</th>
                        <th scope="col">name</th>
                        <th scope="col">email address</th>
                        <th scope="col">profile</th>
                        <th scope="col">email</th>
                        <th scope="col">status</th>
                        <th scope="col">address</th>
                        <th scope="col">gst</th>
                        <th scope="col">pan</th>
                        <th scope="col">phone</th>
                        <th scope="col">handle</th>
                    </tr>
                </thead>
                <tbody>
                    {{#each restaurants}}
                    <tr>
                        <th>{{inc @index 1}}</th>
                        <td>{{this.restaurant_name}}</td>
                        <td>{{this.email}}</td>
                        <td>{{#if this.profile_completed}}completed{{else}}not completed{{/if}}</td>
                        <td>{{#if this.verified}}verified{{else}}not verified{{/if}}</td>
                        <td>{{this.status}}</td>
                        <td>{{#if this.address}}
                            {{this.address}}
                            {{else}}
                            not available
                            {{/if}}
                        </td>
                        <td>
                            {{#if this.gst_number}}
                            {{this.gst_number}}
                            {{else}}
                            not available
                            {{/if}}
                        </td>
                        <td>
                            {{#if this.pan_number}}
                            {{this.pan_number}}
                            {{else}}
                            not available
                            {{/if}}
                        </td>
                        <td>
                            {{#if this.phone}}
                            {{this.phone}}
                            {{else}}
                            not available
                            {{/if}}
                        </td>
                        <td>
                            <button type="button" class=" text-white btn btn-danger w-75  ml-2" style="height: 40px;"
                                data-toggle="modal" onclick="banRestaurant('{{this._id}}')">
                                ban
                            </button>
                        </td>
                    </tr>
                    {{/each}}
                </tbody>
            </table>
            {{!-- <div class=" row p-2 d-flex-column justify-content-center align-items-center restaurant-details">
                                <div
                                    class="col-12 col-sm-12 col-lg-2 d-flex-column justify-content-center align-items-center">
                                    <div class="w-100 d-flex  justify-content-center">
                                        <img class="" src="{{this.profile_pic}}"
                                            style="width: 100px; height: 100px; border-radius: 50%;" alt="">
                                    </div>
                                    <h6 class="d-flex justify-content-center restaurant-name">
                                        {{this.restaurant_name}}
                                    </h6>
                                </div>
                                <div class="col-12 col-sm-12 col-lg-5  m-auto">
                                    <div class="">
                                        <h6>
                                            {{this.email}}
                                        </h6>
                                    </div>
                                    <div class="">
                                        <h6>
                                            {{#if this.phone}}
                                            ph : {{this.phone}}
                                            {{else}}
                                            not availabe
                                            {{/if}}
                                        </h6>
                                    </div>
                                    <div>
                                        <h6>
                                            {{#if this.address}}
                                            {{this.address}}
                                            {{else}}
                                            not availabe
                                            {{/if}}
                                        </h6>
                                    </div>
                                    <div>
                                        <h6>
                                            GSTIN :
                                            {{#if this.gst_number}}
                                            {{this.gst_number}}
                                            {{else}}
                                            not availabe
                                            {{/if}}
                                        </h6>
                                    </div>
                                </div>
                                <div class="col-12 col-sm-12 col-lg-3 w-100 justify-content-start m-auto">
                                    <div>
                                        <h6>
                                            request date : {{this.request_date}}
                                        </h6>
                                    </div>
                                    <div>
                                        <h6>
                                            {{#if this.verified}}
                                            email verified
                                            {{else}}
                                            email not verified
                                            {{/if}}
                                        </h6>
                                    </div>
                                    <div>
                                        <h6>
                                            {{#if this.profile_completed}}
                                            profile completed
                                            {{else}}
                                            profile not completed
                                            {{/if}}
                                        </h6>
                                    </div>

                                    <div>
                                        <h6>
                                            total tables : {{this.tables.length}}
                                        </h6>
                                    </div>
                                    <div>
                                        <h6>
                                            PAN :
                                            {{#if this.pan_number}}
                                            {{this.pan_number}}
                                            {{else}}
                                            not availabe
                                            {{/if}}
                                        </h6>
                                    </div>
                                </div>

                                <div class="col-12 col-sm-12 w-100 col-lg-2 d-flex justify-content-center">
                                    <button type="button" class=" text-white btn btn-danger w-75  ml-2"
                                        style="height: 40px;" data-toggle="modal" data-target="#ban{{this._id}}">
                                        ban
                                    </button>
                                </div>
        </div>
        <hr>
        <!-- Modal approve restaurant -->
        <div class="modal fade" id="ban{{this._id}}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
            aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">confirm</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <h6>approve this restaurant</h6>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">cancel</button>
                        <button type="button" class="btn btn-primary"
                            onclick="banRestaurant('{{this._id}}')">confirm</button>
                    </div>
                </div>
            </div>
        </div> --}}
        {{else}}
        <div class="d-flex justify-content-center align-items-center">
            <div class="d-flex justify-content-center align-items-center w-75 alert alert-warning" role="alert">
                no new restaurants found
            </div>
        </div>
        {{/checklength}}
    </div>
    </div>
</section>

<style>

</style>
<script>
    $(document).ready(function () {
        $('#myTable').dataTable();
    });
    const baseUrl = window.location.origin
    function banRestaurant(restaurantId) {
        fetch(`${baseUrl}/admin/ban-restaurant/${restaurantId}`, {
            method: "PUT"
        }).then((response) => response.json()).then((response) => {
            location.reload()
        }).catch(() => {
            alert("restaurant not banned")
        })
    }
</script>